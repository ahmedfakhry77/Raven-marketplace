{"version":3,"file":"VueAnimXyz.js","sources":["../../../utils/getXyzAnimationHook.js","../../../utils/getXyzElementMode.js","../../../utils/getXyzDurationForMode.js","../../../utils/xyzTransitionClasses.js","../src/utils.js","../../../utils/deleteUndefined.js","../src/components/XyzTransition.js","../src/components/XyzTransitionGroup.js","../src/directives/xyz.js","../src/index.js"],"sourcesContent":["import getXyzDurationForMode from './getXyzDurationForMode'\nimport getXyzElementMode from './getXyzElementMode'\n\nfunction clearXyzElementProperties(el) {\n\tif (el._xyzAppearObserver) {\n\t\tel._xyzAppearObserver.disconnect()\n\t}\n\tif (el._xyzAnimTimeout) {\n\t\tclearTimeout(el._xyzAnimTimeout)\n\t}\n\tel.removeEventListener('animationend', el._xyzAnimEnd)\n\tel.removeEventListener('animationcancelled', el._xyzAnimEnd)\n\n\tdelete el._xyzAppearObserver\n\tdelete el._xyzAnimTimeout\n\tdelete el._xyzAnimEnd\n}\n\nexport default function (duration, appearVisible) {\n\treturn (el, done) => {\n\t\tclearXyzElementProperties(el)\n\n\t\tfunction xyzAnimDone() {\n\t\t\tclearXyzElementProperties(el)\n\t\t\tdone()\n\t\t}\n\n\t\tconst mode = getXyzElementMode(el)\n\n\t\tfunction runAnim() {\n\t\t\tconst modeDuration = getXyzDurationForMode(mode, duration)\n\n\t\t\tif (typeof modeDuration === 'number') {\n\t\t\t\tel._xyzAnimTimeout = setTimeout(xyzAnimDone, modeDuration)\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst xyzModeKeyframes = `xyz-${mode}-keyframes`\n\t\t\tconst xyzEls = new Set([el])\n\n\t\t\tif (modeDuration === 'auto') {\n\t\t\t\tconst xyzNestedEls = el.querySelectorAll(`.xyz-nested, .xyz-${mode}-nested`)\n\t\t\t\txyzNestedEls.forEach(xyzEls.add, xyzEls)\n\t\t\t}\n\n\t\t\tfunction removeXyzEl(xyzEl) {\n\t\t\t\txyzEls.delete(xyzEl)\n\t\t\t\tif (xyzEls.size === 0) {\n\t\t\t\t\txyzAnimDone()\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// After one tick remove any elements that are dont have active animations\n\t\t\tel._xyzAnimTimeout = setTimeout(() => {\n\t\t\t\txyzEls.forEach((xyzEl) => {\n\t\t\t\t\t// Remove if element isnt visible\n\t\t\t\t\tconst visible = xyzEl.offsetParent || xyzEl.getClientRects().length\n\t\t\t\t\tif (!visible) {\n\t\t\t\t\t\tremoveXyzEl(xyzEl)\n\t\t\t\t\t}\n\n\t\t\t\t\t// Remove if element has xyz animation overridden\n\t\t\t\t\tconst animationName = window.getComputedStyle(xyzEl).getPropertyValue('animation-name')\n\t\t\t\t\tif (animationName.indexOf(xyzModeKeyframes) === -1) {\n\t\t\t\t\t\tremoveXyzEl(xyzEl)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t})\n\n\t\t\tel._xyzAnimEnd = (event) => {\n\t\t\t\tif (event.animationName === xyzModeKeyframes) {\n\t\t\t\t\tremoveXyzEl(event.target)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tel.addEventListener('animationend', el._xyzAnimEnd, false)\n\t\t\tel.addEventListener('animationcancelled', el._xyzAnimEnd, false)\n\t\t}\n\n\t\tif (mode === 'appear' && appearVisible) {\n\t\t\tconst observerOptions = { ...appearVisible }\n\t\t\tel.classList.add('xyz-paused-all')\n\t\t\tel._xyzAppearObserver = new IntersectionObserver((entries, observer) => {\n\t\t\t\tentries.forEach((entry) => {\n\t\t\t\t\tif (entry.isIntersecting) {\n\t\t\t\t\t\tel.classList.remove('xyz-paused-all')\n\t\t\t\t\t\tobserver.disconnect()\n\t\t\t\t\t\trunAnim()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}, observerOptions)\n\t\t\tel._xyzAppearObserver.observe(el)\n\t\t} else {\n\t\t\trunAnim()\n\t\t}\n\t}\n}\n","export default function (el) {\n\tif (el.classList.contains('xyz-appear')) {\n\t\treturn 'appear'\n\t}\n\tif (el.classList.contains('xyz-in')) {\n\t\treturn 'in'\n\t}\n\tif (el.classList.contains('xyz-out')) {\n\t\treturn 'out'\n\t}\n\treturn null\n}\n","export default function (mode, duration) {\n\tswitch (typeof duration) {\n\t\tcase 'number':\n\t\t\treturn duration\n\t\tcase 'string':\n\t\t\treturn duration\n\t\tcase 'object':\n\t\t\tif (duration === null) return null\n\t\t\treturn duration[mode]\n\t}\n\treturn null\n}\n","export default {\n\tappearFrom: 'xyz-appear-from',\n\tappearActive: 'xyz-appear',\n\tappearTo: 'xyz-appear-to',\n\tinFrom: 'xyz-in-from',\n\tinActive: 'xyz-in',\n\tinTo: 'xyz-in-to',\n\toutFrom: 'xyz-out-from',\n\toutActive: 'xyz-out',\n\toutTo: 'xyz-out-to',\n}\n","import { deleteUndefined, xyzTransitionClasses, getXyzAnimationHook } from '../../../utils'\nimport { mergeData as vueFunctionalDataMerge } from 'vue-functional-data-merge'\n\nexport const xyzTransitionProps = {\n\tappear: Boolean,\n\tappearVisible: [Boolean, Object],\n\tduration: [Number, String, Object],\n\tmode: String,\n\tappearClass: String,\n\tappearActiveClass: String,\n\tappearToClass: String,\n\tenterClass: String,\n\tenterActiveClass: String,\n\tenterToClass: String,\n\tleaveClass: String,\n\tleaveActiveClass: String,\n\tleaveToClass: String,\n}\n\nexport const xyzTransitionGroupProps = {\n\t...xyzTransitionProps,\n\ttag: {\n\t\ttype: String,\n\t\tdefault: 'div',\n\t},\n\tmoveClass: String,\n}\n\nexport function mergeData(data1 = {}, data2 = {}) {\n\treturn vueFunctionalDataMerge(data1, data2)\n}\n\nexport function getXyzTransitionData(data) {\n\tdeleteUndefined(data.attrs)\n\tdata.attrs.appear = Boolean(data.attrs.appear || data.attrs.appearVisible)\n\tconst { appear, appearVisible, duration } = data.attrs\n\n\tconst animationHook = getXyzAnimationHook(duration, appearVisible)\n\n\tconst transitionData = {\n\t\tattrs: {\n\t\t\tcss: true,\n\t\t\ttype: 'animation',\n\t\t\tappearClass: xyzTransitionClasses.appearFrom,\n\t\t\tappearActiveClass: xyzTransitionClasses.appearActive,\n\t\t\tappearToClass: xyzTransitionClasses.appearTo,\n\t\t\tenterClass: xyzTransitionClasses.inFrom,\n\t\t\tenterActiveClass: xyzTransitionClasses.inActive,\n\t\t\tenterToClass: xyzTransitionClasses.inTo,\n\t\t\tleaveClass: xyzTransitionClasses.outFrom,\n\t\t\tleaveActiveClass: xyzTransitionClasses.outActive,\n\t\t\tleaveToClass: xyzTransitionClasses.outTo,\n\t\t},\n\t\ton: {\n\t\t\tenter: animationHook,\n\t\t\tleave: animationHook,\n\t\t},\n\t}\n\n\tif (appear) {\n\t\ttransitionData.on.appear = animationHook\n\t}\n\n\tconst mergedData = mergeData(transitionData, data)\n\n\tdelete mergedData.attrs.appearVisible\n\tdelete mergedData.attrs.duration\n\treturn mergedData\n}\n","export default function (obj) {\n\tObject.keys(obj).forEach((key) => {\n\t\tif (obj[key] === undefined) {\n\t\t\tdelete obj[key]\n\t\t}\n\t})\n}\n","import { xyzTransitionProps, mergeData, getXyzTransitionData } from '../utils'\n\nexport default {\n\tname: 'XyzTransition',\n\tfunctional: true,\n\tprops: xyzTransitionProps,\n\trender(createElement, context) {\n\t\tconst { data = {}, props = {}, children = [] } = context\n\n\t\tconst newData = getXyzTransitionData({\n\t\t\t...data,\n\t\t\tattrs: {\n\t\t\t\t...data.attrs,\n\t\t\t\t...props,\n\t\t\t},\n\t\t})\n\n\t\tchildren.forEach((node) => {\n\t\t\t// Iterate through children and merge transition directives and styles\n\t\t\tnode.data = mergeData(data, node.data)\n\t\t})\n\n\t\treturn createElement('transition', newData, children)\n\t},\n}\n","import { xyzTransitionGroupProps, mergeData, getXyzTransitionData } from '../utils'\n\nfunction getTransitionRawChildren(children) {\n\treturn children.filter((node) => {\n\t\treturn node.tag && node.key != null && String(node.key).indexOf('__vlist') !== 0\n\t})\n}\n\nexport default {\n\tname: 'XyzTransitionGroup',\n\tfunctional: true,\n\tprops: xyzTransitionGroupProps,\n\trender(createElement, context) {\n\t\tconst { data = {}, props = {}, children = [] } = context\n\n\t\tconst newData = getXyzTransitionData({\n\t\t\t...data,\n\t\t\tattrs: {\n\t\t\t\t...data.attrs,\n\t\t\t\t...props,\n\t\t\t},\n\t\t})\n\n\t\tconst rawChildren = getTransitionRawChildren(children)\n\t\trawChildren.forEach((node, index) => {\n\t\t\t// Iterate through children and apply xyz indexes\n\t\t\tnode.data = mergeData(\n\t\t\t\t{\n\t\t\t\t\tstaticStyle: {\n\t\t\t\t\t\t'--xyz-index': index,\n\t\t\t\t\t\t'--xyz-index-rev': children.length - index - 1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tnode.data\n\t\t\t)\n\t\t})\n\n\t\treturn createElement('transition-group', newData, children)\n\t},\n}\n","import clsx from 'clsx'\n\nfunction updateDirective(el, { value }) {\n\tel.setAttribute('xyz', clsx(el._xyzOriginal, value))\n}\n\nexport default {\n\tbind(el) {\n\t\tel._xyzOriginal = el.getAttribute('xyz')\n\t\tupdateDirective(...arguments)\n\t},\n\tupdate: updateDirective,\n}\n","import XyzTransition from './components/XyzTransition'\nimport XyzTransitionGroup from './components/XyzTransitionGroup'\n\nimport xyz from './directives/xyz'\n\n// Create module definition for Vue.use()\nconst VueAnimXyz = {\n\tinstall(Vue) {\n\t\tVue.component('XyzTransition', XyzTransition)\n\t\tVue.component('XyzTransitionGroup', XyzTransitionGroup)\n\n\t\tVue.directive('xyz', xyz)\n\t},\n}\n\n// Auto-install when vue is found (eg. in browser via <script> tag)\nlet GlobalVue = null\nif (typeof window !== 'undefined') {\n\tGlobalVue = window.Vue\n} else if (typeof global !== 'undefined') {\n\tGlobalVue = global.Vue\n}\nif (GlobalVue) {\n\tGlobalVue.use(VueAnimXyz)\n}\n\nexport { XyzTransition, XyzTransitionGroup, xyz }\nexport default VueAnimXyz\n"],"names":["clearXyzElementProperties","el","_xyzAppearObserver","disconnect","_xyzAnimTimeout","clearTimeout","removeEventListener","_xyzAnimEnd","duration","appearVisible","done","xyzAnimDone","mode","classList","contains","getXyzElementMode","runAnim","modeDuration","getXyzDurationForMode","xyzModeKeyframes","xyzEls","Set","querySelectorAll","forEach","add","setTimeout","xyzEl","offsetParent","getClientRects","length","removeXyzEl","window","getComputedStyle","getPropertyValue","indexOf","event","animationName","target","addEventListener","delete","size","observerOptions","IntersectionObserver","entries","observer","entry","isIntersecting","remove","observe","xyzTransitionProps","appear","Boolean","Object","Number","String","appearClass","appearActiveClass","appearToClass","enterClass","enterActiveClass","enterToClass","leaveClass","leaveActiveClass","leaveToClass","xyzTransitionGroupProps","tag","type","default","moveClass","mergeData","data1","data2","vueFunctionalDataMerge","getXyzTransitionData","data","obj","attrs","keys","key","undefined","animationHook","getXyzAnimationHook","transitionData","css","xyzTransitionClasses","on","enter","leave","mergedData","name","functional","props","render","createElement","context","children","newData","node","filter","getTransitionRawChildren","index","staticStyle","updateDirective","value","setAttribute","clsx","_xyzOriginal","bind","getAttribute","arguments","update","VueAnimXyz","install","Vue","component","XyzTransition","XyzTransitionGroup","directive","xyz","GlobalVue","global","use"],"mappings":"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"}